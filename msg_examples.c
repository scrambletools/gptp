#include <stdlib.h>

////////////
// gPTP message examples (based on Apple)
////////////

// Apple Mac Mini gptp announce
static uint8_t pdu_gptp_announce[] = {
    0x1b, // majorSdoId: gPTP domain (0x1), messageType: announce message (0xb)
    0x02, // minorVersionPTP: 0, versionPTP: 2
    0x00,0x4c, // messageLength: 76
    0x00, // domainNumber: 0
    0x00, // minorSdoId: 0
    0x00,0x08, // flags: two-step: false, ptp_timescale: true, ptp_utc_reasonable: false
    0x00,0x00,0x00,0x00,0x00,0x00, // correctionField: correctionNs: 0.000000ns
    0x00,0x00, // correctionField: correctionSubNs: 0
    0x00,0x00,0x00,0x00, // messageTypeSpecific: 0
    0x14,0x98,0x77,0x40,0xc7,0x88,0x00,0x02, // clockIdentity
    0x00,0x01, // sourcePortID: 1
    0x00,0x0d, // sequenceID: 13
    0x05, // controlField: other message (5)
    0x00, // logMessagePeriod: 0 (1.000000s)
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // reserved
    0x00,0x25, // originCurrentUTCOffset: 37
    0x00, // reserved
    0xf8, // priority1: 248
    0xf8, // grandmasterClockClass: 248
    0x21, // grandmasterClockAccuracy: accurate to within 100ns (0x21)
    0x43,0x6a, // grandmasterClockVariance: 17258
    0xeb, // priority2: 235
    0x14,0x98,0x77,0x40,0xc7,0x88,0x00,0x02, // grandmasterClockIdentity
    0x00,0x00, // localStepsRemoved: 0
    0xa0, // timeSource: internal_oscillator (0xa0)
    0x00,0x08, // path trace tlv: tlvType: path trace (0x0008)
    0x00,0x08, // path trace tlv: lengthField: 8 (1 clockIdentity in the array)
    0x14,0x98,0x77,0x40,0xc7,0x88,0x00,0x02, // path trace tlv: pathSequence
}; // 76 bytes

// Apple Mac Mini gptp signalling (Apple proprietary tlvs)
static uint8_t pdu_gptp_signalling[] = {
    0x1c, // majorSdoId: gPTP domain (0x1), messageType: signalling message (0xc)
    0x02, // minorVersionPTP: 0, versionPTP: 2
    0x00,0x4c, // messageLength: 106
    0x00, // domainNumber: 0
    0x00, // minorSdoId: 0
    0x00,0x08, // flags: two-step: false, ptp_timescale: true, ptp_utc_reasonable: false
    0x00,0x00,0x00,0x00,0x00,0x00, // correctionField: correctionNs: 0.000000ns
    0x00,0x00, // correctionField: correctionSubNs: 0
    0x00,0x00,0x00,0x00, // messageTypeSpecific: 0
    0x14,0x98,0x77,0x40,0xc7,0x88,0x00,0x02, // clockIdentity
    0x00,0x01, // sourcePortID: 1
    0x00,0x0c, // sequenceID: 12
    0x05, // controlField: other message (5)
    0x80, // logMessagePeriod: -128 (0.000000s)
    0x1c,0x57,0xdc,0x6f,0xb4,0x19,0x00,0x02, // targetPortIdentity: clock
    0x00,0x06, // targetPortIdentity: portNumber: 6
    0x00,0x03, // tlv: tlvType: organization extension (0x0003)
    0x00,0x16, // tlv: lengthField: 22
    0x00,0x0d,0x93, // tlv: organizationId: unknown (0x000d93)
    0x00,0x00,0x01, // tlv: organizationSubType: 1
    0x00,0x07,0x01,0x01,0x00,0x00,0x27,0x10,0x00,0x00,0x27,0x10,0x00,0x28,0xa4,0x2d, // ?
    0x00,0x03, // 2nd tlv: tlvType 3
    0x00,0x20, // 2nd tlv: lengthField 32
    0x00,0x0d,0x93, // 2nd tlv: organizationId: unknown (0x000d93)
    0x00,0x00,0x05, // organizationSubType: 5
    0x00,0x1f,0x01,0x01,0x00,0x00,0x00,0x00,0x27,0x10,0x00,0x00,0x27,0x10,0x00,0x00, // ?
    0x27,0x10,0x00,0x00,0x27,0x10,0x00,0x28,0xa4,0x2d // ?
}; // 106 bytes

// Apple Mac Mini gptp sync
static uint8_t pdu_gptp_sync[] = {
    0x10, // majorSdoId: gPTP domain (0x1), messageType: sync message (0x0)
    0x02, // minorVersionPTP: 0, versionPTP: 2
    0x00,0x2c, // messageLength: 44
    0x00, // domainNumber: 0
    0x00, // minorSdoId: 0
    0x02,0x08, // flags: ptp_two_step: true, ptp_timescale: true, ptp_utc_reasonable: false
    0x00,0x00,0x00,0x00,0x00,0x00, // correctionField: correctionNs: 0.000000ns
    0x00,0x00, // correctionField: correctionSubNs: 0
    0x00,0x00,0x00,0x00, // messageTypeSpecific: 0
    0x14,0x98,0x77,0x40,0xc7,0x88,0x00,0x02, // clockIdentity
    0x00,0x01, // sourcePortID: 1
    0x00,0x59, // sequenceID: 89
    0x00, // controlField: sync message (0)
    0xfd, // logMessagePeriod: -3 (0.125000s)
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // reserved
    0x00,0x00 // padding (not counted in messageLength)
}; // 44 bytes

// Apple Mac Mini gptp follow up
static uint8_t pdu_gptp_follow_up[] = {
    0x18, // majorSdoId: gPTP domain (0x1), messageType: follow up message (0x8)
    0x02, // minorVersionPTP: 0, versionPTP: 2
    0x00,0x60, // messageLength: 96
    0x00, // domainNumber: 0
    0x00, // minorSdoId: 0
    0x00,0x08, // flags: ptp_two_step: false, ptp_timescale: true, ptp_utc_reasonable: false
    0x00,0x00,0x00,0x00,0x8d,0x75, // correctionField: correctionNs: 36213.000000ns
    0x00,0x00, // correctionField: correctionSubNs: 0
    0x00,0x00,0x00,0x00, // messageTypeSpecific: 0
    0x14,0x98,0x77,0x40,0xc7,0x88,0x00,0x02, // clockIdentity
    0x00,0x01, // sourcePortID: 1
    0x00,0x59, // sequenceID: 89
    0x02, // controlField: follow_up message (2)
    0xfd, // logMessagePeriod: -3 (0.125000s)
    0x00,0x00,0x00,0x00,0x6b,0xb4, // preciseOriginTimestamp (seconds): 27572
    0x32,0x88,0xdf,0x5b, // preciseOriginTimestamp (nanoseconds): 847830875
    0x00,0x03, // followup information tlv: tlvType: organization extension (0x0003)
    0x00,0x1c, // followup information tlv: lengthField: 28
    0x00,0x80,0xc2, // followup information tlv: organizationId: 32962
    0x00,0x00,0x01, // followup information tlv: organizationSubType: 1
    0x00,0x00,0x00,0x00, // followup information tlv: cumulativeScaledRateOffset: 0
    0x00,0x00, // followup information tlv: gmTimeBaseIndicator: 0
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // followup information tlv: lastGMPhaseChange
    0x00,0x00,0x00,0x00, // followup information tlv: scaledLastGmFreqChange: 0
    0x00,0x03, // apple tlv: tlvType: organization extension (0x0003)
    0x00,0x10, // apple tlv: lengthField: 16
    0x00,0x0d,0x93,0x00,0x00,0x04,0x14,0x98,0x77,0x40,0xc7,0x88, // apple tlv: uknown data (ignore)
    0x00,0x02,0x00,0x00, // apple tlv: uknown data (ignore)
    0x00,0x03,0x00,0x32,0x00,0x0d,0x93,0x00,0x00,0x02,0x00,0x00,0x00,0x02,0x78,0x4a, // trailer (not counted in messageLength)
    0x33,0x68,0x95,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x58,0x00,0x00,0x02,0x00, // trailer (not counted in messageLength)
    0x00,0x14,0x9f,0x6e,0x14,0x98,0x77,0x40,0xc7,0x88,0x00,0x02,0x00,0x00,0x00,0x00, // trailer (not counted in messageLength)
    0x6b,0xb4, // trailer (not counted in messageLength)
    0x32,0x89,0x6d,0x28 // frame check sequence (not counted in messageLength)
}; // 96 bytes (20 bytes unknown)

// Apple Mac Mini gptp peer delay request
static uint8_t pdu_gptp_pdelay_request[] = {
    0x12, // majorSdoId: gPTP domain (0x1), messageType: peer_delay_request message (0x2)
    0x02, // minorVersionPTP: 0, versionPTP: 2
    0x00,0x36, // messageLength: 54
    0x00, // domainNumber: 0
    0x00, // minorSdoId: 0
    0x00,0x08, // flags: ptp_two_step: false, ptp_timescale: true, ptp_utc_reasonable: false
    0x00,0x00,0x00,0x00,0x00,0x00, // correctionField: correctionNs: 0.000000ns
    0x00,0x00, // correctionField: correctionSubNs: 0
    0x00,0x00,0x00,0x00, // messageTypeSpecific: 0
    0x14,0x98,0x77,0x40,0xc7,0x88,0x00,0x02, // clockIdentity
    0x00,0x01, // sourcePortID: 1
    0x4b,0x3b, // sequenceID: 19259
    0x05, // controlField: other message (5)
    0x00, // logMessagePeriod: 0 (1.000000s)
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // reserved
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 // reserved
}; // 54 bytes

// Apple Mac Mini gptp peer delay reponse
static uint8_t pdu_gptp_pdelay_response[] = {
    0x13, // majorSdoId: gPTP domain (0x1), messageType: peer_delay_response message (0x3)
    0x02, // minorVersionPTP: 0, versionPTP: 2
    0x00,0x36, // messageLength: 54
    0x00, // domainNumber: 0
    0x00, // minorSdoId: 0
    0x02,0x08, // flags: ptp_two_step: true, ptp_timescale: true, ptp_utc_reasonable: false
    0x00,0x00,0x00,0x00,0x00,0x00, // correctionField: correctionNs: 0.000000ns
    0x00,0x00, // correctionField: correctionSubNs: 0
    0x00,0x00,0x00,0x00, // messageTypeSpecific: 0
    0x14,0x98,0x77,0x40,0xc7,0x88,0x00,0x02, // clockIdentity
    0x00,0x01, // sourcePortID: 1
    0x4b,0x5d, // sequenceID: 19293
    0x05, // controlField: other message (5)
    0x7f, // logMessagePeriod: 127
    0x00,0x00,0x00,0x00,0x4b,0x6d, // requestReceiptTimestamp (sec): 19309
    0x0a,0xe4,0x99,0xd3, // requestReceiptTimestamp (nanosec): 182753747
    0x00,0x01,0xf2,0xff,0xfe,0x22,0x3b,0x14, // requestingSourcePortIdentity
    0x00,0x01 // requestingSourcePortId: 1
}; // 54 bytes

// Apple Mac Mini gptp peer delay response follow up
static uint8_t pdu_gptp_pdelay_reponse_follow_up[] = {
    0x1a, // majorSdoId: gPTP domain (0x1), messageType: peer_delay_response_follow_up message (0xa)
    0x02, // minorVersionPTP: 0, versionPTP: 2
    0x00,0x36, // messageLength: 54
    0x00, // domainNumber: 0
    0x00, // minorSdoId: 0
    0x00,0x08, // flags: ptp_two_step: false, ptp_timescale: true, ptp_utc_reasonable: false
    0x00,0x00,0x00,0x00,0x00,0x00, // correctionField: correctionNs: 0.000000ns
    0x00,0x00, // correctionField: correctionSubNs: 0
    0x00,0x00,0x00,0x00, // messageTypeSpecific: 0
    0x14,0x98,0x77,0x40,0xc7,0x88,0x00,0x02, // clockIdentity
    0x00,0x01, // sourcePortID: 1
    0x4b,0x5d, // sequenceID: 19293
    0x05, // controlField: other message (5)
    0x7f, // logMessagePeriod: 127
    0x00,0x00,0x00,0x00,0x4b,0x6d, // responseOriginTimestamp (sec): 19309
    0x0a,0xe8,0x60,0xb5, // responseOriginTimestamp (nanosec): 183001269
    0x00,0x01,0xf2,0xff,0xfe,0x22,0x3b,0x14, // requestingSourcePortIdentity
    0x00,0x01 // requestingSourcePortId: 1
}; // 54 bytes

////////////
// gPTP message examples (based on Motu)
////////////

// Test gptp announce
static uint8_t pdu_gptp_announce[] = {
    0x1b, // majorSdoId: gPTP domain (0x1), messageType: announce message (0xb)
    0x02, // minorVersionPTP: 0, versionPTP: 2
    0x00,0x4c, // messageLength: 76
    0x00, // domainNumber: 0
    0x00, // minorSdoId: 0
    0x00,0x08, // flags: two-step: false, ptp_timescale: true, ptp_utc_reasonable: false
    0x00,0x00,0x00,0x00,0x00,0x00, // correctionField: correctionNs: 0.000000ns
    0x00,0x00, // correctionField: correctionSubNs: 0
    0x00,0x00,0x00,0x00, // messageTypeSpecific: 0
    0x00,0x01,0xf2,0xff,0xfe,0x22,0x3b,0x14, // clockIdentity
    0x00,0x01, // sourcePortID: 1
    0x4b,0x5d, // sequenceID: 19293
    0x02, // controlField: follow_up message (2)
    0x00, // logMessagePeriod: 0 (1.000000s)
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // reserved
    0x00,0x00, // originCurrentUTCOffset: 0
    0x00, // reserved
    0xf6, // priority1: 246
    0xf8, // grandmasterClockClass: 248
    0xfe, // grandmasterClockAccuracy: accuracy unknown (0xfe)
    0x00,0x01, // grandmasterClockVariance: 1
    0xf8, // priority2: 248
    0x00,0x01,0xf2,0xff,0xfe,0x22,0x3b,0x14, // grandmasterClockIdentity
    0x00,0x00, // localStepsRemoved: 0
    0xa0, // timeSource: internal_oscillator (0xa0)
    0x00,0x08, // path trace tlv: path trace (0x0008)
    0x00,0x08, // path trace tlv: lengthField: 8
    0x00,0x01,0xf2,0xff,0xfe,0x22,0x3b,0x14, // path trace tlv: pathSequence
}; // 76 bytes

// Test gptp sync
static uint8_t pdu_gptp_sync[] = {
    0x10, // majorSdoId: gPTP domain (0x1), messageType: sync message (0x0)
    0x02, // minorVersionPTP: 0, versionPTP: 2
    0x00,0x2c, // messageLength: 44
    0x00, // domainNumber: 0
    0x00, // minorSdoId: 0
    0x02,0x08, // flags: ptp_two_step: true, ptp_timescale: true, ptp_utc_reasonable: false
    0x00,0x00,0x00,0x00,0x00,0x00, // correctionField: correctionNs: 0.000000ns
    0x00,0x00, // correctionField: correctionSubNs: 0
    0x00,0x00,0x00,0x00, // messageTypeSpecific: 0
    0x00,0x01,0xf2,0xff,0xfe,0x22,0x3b,0x14, // clockIdentity
    0x00,0x01, // sourcePortID: 1
    0x5a,0xe7, // sequenceID: 23271
    0x00, // controlField: sync message (0)
    0xfd, // logMessagePeriod: -3 (0.125000s)
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // reserved
    0x00,0x00 // padding (not counted in messageLength)
}; // 44 bytes

// Test gptp follow up
static uint8_t pdu_gptp_follow_up[] = {
    0x18, // majorSdoId: gPTP domain (0x1), messageType: follow up message (0x8)
    0x02, // minorVersionPTP: 0, versionPTP: 2
    0x00,0x4c, // messageLength: 76
    0x00, // domainNumber: 0
    0x00, // minorSdoId: 0
    0x00,0x08, // flags: ptp_two_step: false, ptp_timescale: true, ptp_utc_reasonable: false
    0x00,0x00,0x00,0x00,0x00,0x00, // correctionField: correctionNs: 0.000000ns
    0x00,0x00, // correctionField: correctionSubNs: 0
    0x00,0x00,0x00,0x00, // messageTypeSpecific: 0
    0x00,0x01,0xf2,0xff,0xfe,0x22,0x3b,0x14, // clockIdentity
    0x00,0x01, // sourcePortID: 1
    0x5a,0xe7, // sequenceID: 23271
    0x02, // controlField: follow_up message (2)
    0xfd, // logMessagePeriod: -3 (0.125000s)
    0x00,0x00,0x00,0x01,0x4b,0x60, // preciseOriginTimestamp (seconds): 84832
    0x35,0xd6,0xa2,0x98, // preciseOriginTimestamp (nanoseconds): 903258776
    0x00,0x03, // followup information tlv: tlvType: organization extension (0x0003)
    0x00,0x1c, // followup information tlv: lengthField: 28
    0x00,0x80,0xc2, // followup information tlv: organizationId: 32962
    0x00,0x00,0x01, // followup information tlv: organizationSubType: 1
    0x00,0x00,0x00,0x00, // followup information tlv: cumulativeScaledRateOffset: 0
    0x00,0x00, // followup information tlv: gmTimeBaseIndicator: 0
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // followup information tlv: lastGMPhaseChange
    0x00,0x00,0x00,0x00 // followup information tlv: scaledLastGmFreqChange: 0
}; // 76 bytes

// Test gptp peer delay request
static uint8_t pdu_gptp_pdelay_request[] = {
    0x12, // majorSdoId: gPTP domain (0x1), messageType: peer_delay_request message (0x2)
    0x02, // minorVersionPTP: 0, versionPTP: 2
    0x00,0x36, // messageLength: 54
    0x00, // domainNumber: 0
    0x00, // minorSdoId: 0
    0x00,0x08, // flags: ptp_two_step: false, ptp_timescale: true, ptp_utc_reasonable: false
    0x00,0x00,0x00,0x00,0x00,0x00, // correctionField: correctionNs: 0.000000ns
    0x00,0x00, // correctionField: correctionSubNs: 0
    0x00,0x00,0x00,0x00, // messageTypeSpecific: 0
    0x00,0x01,0xf2,0xff,0xfe,0x22,0x3b,0x14, // clockIdentity
    0x00,0x01, // sourcePortID: 1
    0x4b,0x5d, // sequenceID: 19293
    0x05, // controlField: other message (5)
    0x00, // logMessagePeriod: 0 (1.000000s)
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // reserved
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 // reserved
}; // 54 bytes

// Test gptp peer delay reponse
static uint8_t pdu_gptp_pdelay_response[] = {
    0x13, // majorSdoId: gPTP domain (0x1), messageType: peer_delay_response message (0x3)
    0x02, // minorVersionPTP: 0, versionPTP: 2
    0x00,0x36, // messageLength: 54
    0x00, // domainNumber: 0
    0x00, // minorSdoId: 0
    0x02,0x08, // flags: ptp_two_step: true, ptp_timescale: true, ptp_utc_reasonable: false
    0x00,0x00,0x00,0x00,0x00,0x00, // correctionField: correctionNs: 0.000000ns
    0x00,0x00, // correctionField: correctionSubNs: 0
    0x00,0x00,0x00,0x00, // messageTypeSpecific: 0
    0x00,0x01,0xf2,0xff,0xfe,0x22,0x3b,0x14, // clockIdentity
    0x00,0x01, // sourcePortID: 1
    0x4b,0x3b, // sequenceID: 19259
    0x05, // controlField: other message (5)
    0x00, // logMessagePeriod: 0 (1.000000s)
    0x00,0x00,0x00,0x01,0x4b,0x61, // requestReceiptTimestamp (sec): 84833
    0x16,0xda,0x06,0x20, // requestReceiptTimestamp (nanosec): 383387168
    0x14,0x98,0x77,0x40,0xc7,0x88,0x00,0x02, // requestingSourcePortIdentity
    0x00,0x01 // requestingSourcePortId: 1
}; // 54 bytes

// Test gptp peer delay response follow up
static uint8_t pdu_gptp_pdelay_reponse_follow_up[] = {
    0x1a, // majorSdoId: gPTP domain (0x1), messageType: peer_delay_response_follow_up message (0xa)
    0x02, // minorVersionPTP: 0, versionPTP: 2
    0x00,0x36, // messageLength: 54
    0x00, // domainNumber: 0
    0x00, // minorSdoId: 0
    0x00,0x08, // flags: ptp_two_step: false, ptp_timescale: true, ptp_utc_reasonable: false
    0x00,0x00,0x00,0x00,0x00,0x00, // correctionField: correctionNs: 0.000000ns
    0x00,0x00, // correctionField: correctionSubNs: 0
    0x00,0x00,0x00,0x00, // messageTypeSpecific: 0
    0x00,0x01,0xf2,0xff,0xfe,0x22,0x3b,0x14, // clockIdentity
    0x00,0x01, // sourcePortID: 1
    0x4b,0x3b, // sequenceID: 19259
    0x05, // controlField: other message (5)
    0x00, // logMessagePeriod: 0 (1.000000s)
    0x00,0x00,0x00,0x01,0x4b,0x61, // responseOriginTimestamp (sec): 84833
    0x16,0xda,0x67,0xb0, // responseOriginTimestamp (nanosec): 383412144
    0x14,0x98,0x77,0x40,0xc7,0x88,0x00,0x02, // requestingSourcePortIdentity
    0x00,0x01 // requestingSourcePortId: 1
}; // 54 bytes